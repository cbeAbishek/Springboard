<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: layout(~{::title}, ~{::div})}">

<head>
    <title th:text="${testCase.id != null ? 'Edit Test Case' : 'New Test Case'}">Test Case Form</title>
</head>

<body>
    <div>
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="page-title">
                <i class="bi bi-plus-circle me-3" th:if="${testCase.id == null}"></i>
                <i class="bi bi-pencil me-3" th:if="${testCase.id != null}"></i>
                <span th:text="${testCase.id != null ? 'Edit Test Case' : 'New Test Case'}">Test Case Form</span>
            </h1>
            <a th:href="@{/ui/testcases}" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left me-2"></i>Back to Test Cases
            </a>
        </div>

        <div class="card">
            <div class="card-body">
                <form th:action="@{/ui/testcases/save}" th:object="${testCase}" method="post">
                    <input type="hidden" th:field="*{id}">

                    <div class="row">
                        <!-- Basic Information -->
                        <div class="col-md-6">
                            <h5 class="text-primary mb-3">
                                <i class="bi bi-info-circle me-2"></i>Basic Information
                            </h5>

                            <div class="mb-3">
                                <label for="name" class="form-label">Test Case Name *</label>
                                <input type="text" class="form-control" th:field="*{name}" required
                                    placeholder="Enter descriptive test case name">
                            </div>

                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="type" class="form-label">Test Type *</label>
                                    <select class="form-select" th:field="*{type}" required>
                                        <option value="">Select Type</option>
                                        <option value="UI">UI Test</option>
                                        <option value="API">API Test</option>
                                        <option value="INTEGRATION">Integration Test</option>
                                        <option value="UNIT">Unit Test</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="priority" class="form-label">Priority</label>
                                    <select class="form-select" th:field="*{priority}">
                                        <option value="">Select Priority</option>
                                        <option value="HIGH">High</option>
                                        <option value="MEDIUM">Medium</option>
                                        <option value="LOW">Low</option>
                                    </select>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="status" class="form-label">Status</label>
                                    <select class="form-select" th:field="*{status}">
                                        <option value="">Select Status</option>
                                        <option value="Active">Active</option>
                                        <option value="Inactive">Inactive</option>
                                        <option value="Draft">Draft</option>
                                        <option value="Deprecated">Deprecated</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="environment" class="form-label">Environment</label>
                                    <select class="form-select" th:field="*{environment}">
                                        <option value="">Select Environment</option>
                                        <option value="DEV">Development</option>
                                        <option value="STAGING">Staging</option>
                                        <option value="PROD">Production</option>
                                        <option value="UAT">UAT</option>
                                    </select>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="url" class="form-label">Test URL</label>
                                <input type="url" class="form-control" th:field="*{url}"
                                    placeholder="https://example.com">
                            </div>
                        </div>

                        <!-- Additional Information -->
                        <div class="col-md-6">
                            <h5 class="text-success mb-3">
                                <i class="bi bi-gear me-2"></i>Additional Information
                            </h5>

                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="author" class="form-label">Author</label>
                                    <input type="text" class="form-control" th:field="*{author}"
                                        placeholder="Test author name">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="category" class="form-label">Category</label>
                                    <input type="text" class="form-control" th:field="*{category}"
                                        placeholder="e.g., Smoke Test, Regression">
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="estimatedDuration" class="form-label">Estimated Duration (minutes)</label>
                                <input type="number" class="form-control" th:field="*{estimatedDuration}" min="1"
                                    max="1440" placeholder="5">
                            </div>

                            <div class="mb-3">
                                <label for="description" class="form-label">Description</label>
                                <textarea class="form-control" th:field="*{description}" rows="4"
                                    placeholder="Detailed description of what this test case does"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Test Details Section -->
                    <hr class="my-4">
                    <h5 class="text-info mb-3">
                        <i class="bi bi-list-ol me-2"></i>Test Details
                    </h5>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="testSteps" class="form-label">Test Steps</label>
                                <textarea class="form-control" th:field="*{testSteps}" rows="6"
                                    placeholder="1. Open application&#10;2. Enter credentials&#10;3. Click login&#10;4. Verify dashboard"></textarea>
                                <div class="form-text">Enter each step on a new line</div>
                            </div>

                            <div class="mb-3">
                                <label for="prerequisites" class="form-label">Prerequisites</label>
                                <textarea class="form-control" th:field="*{prerequisites}" rows="3"
                                    placeholder="What needs to be setup before running this test?"></textarea>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="expectedResults" class="form-label">Expected Results</label>
                                <textarea class="form-control" th:field="*{expectedResults}" rows="6"
                                    placeholder="What should happen when the test passes?"></textarea>
                            </div>

                            <div class="mb-3">
                                <label for="testData" class="form-label">Test Data</label>
                                <textarea class="form-control" th:field="*{testData}" rows="3"
                                    placeholder="Test data in JSON format or key-value pairs"></textarea>
                                <div class="form-text">JSON format recommended</div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="d-flex justify-content-end gap-2 mt-4">
                        <a th:href="@{/ui/testcases}" class="btn btn-outline-secondary">
                            <i class="bi bi-x-circle me-2"></i>Cancel
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-check-circle me-2"></i>
                            <span th:text="${testCase.id != null ? 'Update Test Case' : 'Create Test Case'}">Save</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Auto-populate some fields based on type selection
        document.getElementById('type').addEventListener('change', function () {
            const urlField = document.getElementById('url');
            const categoryField = document.getElementById('category');

            if (this.value === 'UI') {
                if (!urlField.value) {
                    urlField.value = 'https://google.com';
                }
                if (!categoryField.value) {
                    categoryField.value = 'UI Functional Test';
                }
            } else if (this.value === 'API') {
                if (!urlField.value) {
                    urlField.value = 'https://api.github.com';
                }
                if (!categoryField.value) {
                    categoryField.value = 'API Integration Test';
                }
            }
        });
    </script>
</body>

</html>