<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Documentation - Automation Platform</title>
    <link rel="stylesheet" href="/css/style.css">
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/images/logo.svg">
    <style>
        .docs-layout {
            display: grid;
            grid-template-columns: 260px 1fr;
            gap: 2.5rem;
            align-items: flex-start;
        }

        .docs-sidebar {
            position: sticky;
            top: 8rem;
            height: calc(100vh - 10rem);
            overflow-y: auto;
        }

        .docs-sidebar h3 {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #94a3b8;
            margin: 1.5rem 0 0.75rem;
            padding: 0 1rem;
        }

        .docs-sidebar ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .docs-sidebar a {
            display: block;
            padding: 0.6rem 1rem;
            border-radius: 8px;
            color: #cbd5e1;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
        }

        .docs-sidebar a:hover {
            background-color: rgba(56, 189, 248, 0.1);
            color: #f8fafc;
        }

        .docs-sidebar a.active {
            color: #7dd3fc;
            font-weight: 600;
            border-left-color: #38bdf8;
        }

        .docs-content h2 {
            font-size: 2rem;
            color: #f8fafc;
            margin-top: 3rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(148, 163, 184, 0.2);
        }

        .docs-content h2:first-of-type {
            margin-top: 0;
        }

        .docs-content h3 {
            font-size: 1.5rem;
            color: #e2e8f0;
            margin-top: 2.5rem;
            margin-bottom: 1rem;
        }

        .docs-content pre {
            position: relative;
        }

        .copy-btn {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            background: rgba(51, 65, 85, 0.7);
            border: 1px solid rgba(100, 116, 139, 0.5);
            color: #e2e8f0;
            padding: 0.3rem 0.6rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            opacity: 0.7;
            transition: all 0.2s ease;
        }

        .copy-btn:hover {
            opacity: 1;
            background: #38bdf8;
            color: #0f172a;
        }
    </style>
</head>
<body>
<header th:replace="~{fragments/nav :: app-nav}"></header>
<main class="container">
    <section class="card page-header">
        <div class="card-header">
            <h1>Automation Platform Documentation</h1>
            <p>Your hub for linking repositories, authenticating users, and scaling UI &amp; API automation.</p>
        </div>
        <div class="page-header__meta">
            <span class="chip"><strong>Version</strong> 1.0</span>
            <span class="chip"><strong>Last updated</strong> <span th:text="${#dates.format(#dates.createNow(), 'yyyy-MM-dd')}">2025-10-13</span></span>
        </div>
    </section>

    <div class="docs-layout">
        <aside class="docs-sidebar">
            <nav class="docs-nav">
                <h3>Getting Started</h3>
                <ul>
                    <li><a href="#introduction">Introduction</a></li>
                    <li><a href="#authentication">Authentication</a></li>
                </ul>

                <h3>Core Features</h3>
                <ul>
                    <li><a href="#test-management">Test Management</a></li>
                    <li><a href="#api-testing">API Testing</a></li>
                    <li><a href="#ui-testing">UI Testing</a></li>
                </ul>

                <h3>Automation & CI/CD</h3>
                <ul>
                    <li><a href="#github-actions">GitHub Actions</a></li>
                    <li><a href="#trigger-api">Trigger API</a></li>
                    <li><a href="#scheduling">Scheduling</a></li>
                </ul>

                <h3>Analysis</h3>
                <ul>
                    <li><a href="#reports">Reports</a></li>
                    <li><a href="#analytics">Analytics</a></li>
                </ul>
            </nav>
        </aside>

        <div class="docs-content">
            <section id="introduction" class="card">
                <h2>Introduction</h2>
                <p>Welcome to the Automation Platform, your central hub for managing, executing, and analyzing automated tests. This platform is designed to provide a seamless experience for quality assurance, from writing tests to sharing reports with stakeholders.</p>
                <p>Our goal is to empower your team to ship faster with higher confidence by providing powerful tools for UI and API testing, CI/CD integration, and insightful analytics.</p>
            </section>

            <section id="authentication" class="card">
                <h2>Authentication with Clerk</h2>
                <p>User management is handled by Clerk, providing enterprise-grade security and a wide range of authentication options.</p>
                <ul>
                    <li><strong>Supported Methods:</strong> Email/password, Google, GitHub, and GitLab.</li>
                    <li><strong>Configuration:</strong> To enable Clerk, you must provide your instance keys in the <code>application.properties</code> file or as environment variables. The platform will automatically detect them and enable the login/registration system.</li>
                    <li><strong>JWT Verification:</strong> All incoming API requests are validated using the JSON Web Key Set (JWKS) provided by Clerk, ensuring every request is authenticated securely.</li>
                </ul>
                <pre><code class="language-properties">clerk.publishable-key=pk_live_xxx
clerk.frontend-api=clerk.your-domain.clerk.accounts.dev
clerk.jwks-url=https://clerk.your-domain.clerk.accounts.dev/.well-known/jwks.json
clerk.issuer=https://clerk.your-domain.clerk.accounts.dev
clerk.audience=https://automation.example.com</code></pre>
            </section>

            <section id="test-management" class="card">
                <h2>Test Management</h2>
                <p>The Test Management dashboard is where you define and organize your test cases. Tests are categorized as either "API" or "UI" and can be created individually or imported in bulk using a JSON file.</p>
                <h3>Bulk Importing Tests</h3>
                <p>To import multiple tests at once, create a JSON file with a root `tests` array. Each object in the array should define a test with its `name`, `type`, and `definition`.</p>
                <pre><code class="language-json">{
  "tests": [
    {
      "name": "API - Get User Profile",
      "type": "API",
      "definition": { ... }
    },
    {
      "name": "UI - Login Flow",
      "type": "UI",
      "definition": { ... }
    }
  ]
}</code></pre>
            </section>

            <section id="api-testing" class="card">
                <h2>API Testing</h2>
                <p>Define multi-step API tests with detailed assertions. Each request in a test can have its own method, URL, headers, and body. The platform supports chaining requests and validating responses.</p>
                <h3>Example API Test Definition</h3>
                <pre><code class="language-json">{
  "requests": [
    {
      "name": "Get Auth Token",
      "method": "POST",
      "url": "https://api.example.com/auth/token",
      "body": {
        "clientId": "abc",
        "clientSecret": "123"
      },
      "expectedStatus": 200
    },
    {
      "name": "Get User Data",
      "method": "GET",
      "url": "https://api.example.com/users/me",
      "headers": {
        "Authorization": "Bearer ${outputs['Get Auth Token'].body.token}"
      },
      "expectedStatus": 200
    }
  ]
}</code></pre>
            </section>

            <section id="ui-testing" class="card">
                <h2>UI Testing</h2>
                <p>Create end-to-end user interface tests with a simple, declarative syntax. The platform's runner interprets these steps to interact with a browser.</p>
                <h3>Example UI Test Definition</h3>
                <pre><code class="language-json">{
  "steps": [
    {
      "action": "navigate",
      "url": "https://example.com/login"
    },
    {
      "action": "type",
      "selector": "#email",
      "text": "test@example.com"
    },
    {
      "action": "type",
      "selector": "#password",
      "text": "password123"
    },
    {
      "action": "click",
      "selector": "button[type='submit']"
    },
    {
      "action": "waitFor",
      "selector": ".dashboard-header"
    }
  ]
}</code></pre>
            </section>

            <section id="github-actions" class="card">
                <h2>Dynamic GitHub Actions Workflow</h2>
                <p>The platform generates a bespoke workflow for every project. This file is pre-configured with the correct endpoint, project identifier, and secret token, enabling immediate CI/CD integration.</p>
                <ol>
                    <li>Navigate to the <strong>Dashboard</strong> and select a project.</li>
                    <li>Click the <strong>Download workflow file</strong> button.</li>
                    <li>Commit the downloaded YAML file to your repository at <code>.github/workflows/automation.yml</code>.</li>
                </ol>
                <p>Now, every push to your configured branches will automatically trigger a test run.</p>
            </section>

            <section id="trigger-api" class="card">
                <h2>Trigger API Details</h2>
                <p>The GitHub workflow calls a secure endpoint to initiate a test run. You can also use this API to trigger runs from other systems.</p>
                <ul>
                    <li><strong>Endpoint:</strong> <code>POST /api/run/project/{projectId}</code></li>
                    <li><strong>Authentication:</strong> Include the project's automation token in the <code>X-AUTOMATION-TOKEN</code> header.</li>
                    <li><strong>Body:</strong> The request body is currently ignored but is reserved for future use.</li>
                </ul>
            </section>

            <section id="scheduling" class="card">
                <h2>Scheduling</h2>
                <p>Use the <strong>Scheduler</strong> to configure recurring test runs for any project. This is ideal for nightly regression suites or hourly health checks.</p>
                <p>Schedules are defined using cron expressions, giving you fine-grained control over when runs are executed.</p>
            </section>

            <section id="reports" class="card">
                <h2>Reports</h2>
                <p>The <strong>Reports</strong> page provides a detailed history of every test run. You can filter by project, status, or date range. Each report includes:</p>
                <ul>
                    <li>Execution status (Passed, Failed, Skipped).</li>
                    <li>Timestamps and duration.</li>
                    <li>Screenshots and logs for failed UI test steps.</li>
                    <li>Full request/response details for failed API tests.</li>
                </ul>
            </section>

            <section id="analytics" class="card">
                <h2>Analytics</h2>
                <p>The <strong>Regression</strong> dashboard offers a high-level view of your project's quality over time. Track key metrics like pass/fail rates, test duration trends, and failure frequency to identify patterns and make informed decisions.</p>
            </section>
        </div>
    </div>
</main>
<footer class="container" style="margin-top:3rem;">
    <small>&copy; <span th:text="${#dates.format(#dates.createNow(), 'yyyy')}">2025</span> Automation Platform. All rights reserved.</small>
</footer>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Copy to clipboard for code blocks
        document.querySelectorAll('pre').forEach(pre => {
            const button = document.createElement('button');
            button.className = 'copy-btn';
            button.textContent = 'Copy';
            pre.appendChild(button);

            button.addEventListener('click', () => {
                const code = pre.querySelector('code').innerText;
                navigator.clipboard.writeText(code).then(() => {
                    button.textContent = 'Copied!';
                    setTimeout(() => {
                        button.textContent = 'Copy';
                    }, 2000);
                });
            });
        });

        // Active state for docs navigation
        const sections = document.querySelectorAll('.docs-content section');
        const navLinks = document.querySelectorAll('.docs-nav a');

        const observer = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    navLinks.forEach(link => {
                        link.classList.toggle('active', link.getAttribute('href').substring(1) === entry.target.id);
                    });
                }
            });
        }, { rootMargin: "-50% 0px -50% 0px" });

        sections.forEach(section => {
            observer.observe(section);
        });
    });
</script>

</body>
</html>
